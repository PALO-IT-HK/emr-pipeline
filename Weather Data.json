{"paragraphs":[{"text":"%md\n\n# Weather Data\n","user":"anonymous","dateUpdated":"2018-04-05T19:34:42+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Weather Data</h1>\n"}]},"apps":[],"jobName":"paragraph_1522956754876_1887970513","id":"20180405-154027_1650675872","dateCreated":"2018-04-05T19:32:34+0000","dateStarted":"2018-04-05T19:34:43+0000","dateFinished":"2018-04-05T19:34:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:256"},{"text":"%pyspark\n\nfrom pyspark.sql import SparkSession\n\nspark = SparkSession\\\n    .builder\\\n    .appName(\"WeatherData-ETL\")\\\n    .getOrCreate()\n    \n# Dev\ndebug = True\n\n# S3 Bucket for raw data\ns3_bucket = \"beda-emr-testdata\"\n\nweather_path = \"/weather-midas\"\nwxhrly_raw = \"/wxhrly-raw/*.txt\"\nrainhrly_raw = \"/rainhrly-raw/*.txt\"\nprocessed_path = \"/processed\"\n\n# all stations\nstation_src_list = \"/src_id_list.txt\"\n\n\n","user":"anonymous","dateUpdated":"2018-04-05T19:34:43+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1522956754877_1887585764","id":"20180405-154114_2085691946","dateCreated":"2018-04-05T19:32:34+0000","dateStarted":"2018-04-05T19:34:43+0000","dateFinished":"2018-04-05T19:34:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:257"},{"text":"%pyspark\n\n# Only extract data from Heathrow\n\nspark.read.csv(\"\".join([\"s3a://\", s3_bucket, weather_path, station_src_list]),\\\n              header=\"true\",\\\n              inferSchema=\"true\",\\\n              sep=\"\\t\")\\\n          .filter(\"SRC_NAME = 'HEATHROW'\")\\\n          .createOrReplaceGlobalTempView('londonstation')\nlondonstation_df = spark.sql(\"select * from global_temp.londonstation\")\n\nif debug:\n    londonstation_df.printSchema()\n    londonstation_df.show()\n","user":"anonymous","dateUpdated":"2018-04-05T19:34:43+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- SRC_ID: string (nullable = true)\n |-- SRC_NAME: string (nullable = true)\n |-- ID_T: string (nullable = true)\n |-- ID: string (nullable = true)\n |-- MET_DOMA: string (nullable = true)\n |-- SRC_CAP_BG: string (nullable = true)\n |-- SRC_CAP_EN: string (nullable = true)\n |-- LOC_: string (nullable = true)\n |-- POST_CODE: string (nullable = true)\n |-- HIGH_PRCN_LAT: double (nullable = true)\n |-- HIGH_PRCN_LON: double (nullable = true)\n |-- GRID: string (nullable = true)\n |-- EAST_GRID_REF: integer (nullable = true)\n |-- NORTH_GRID_REF: integer (nullable = true)\n |-- ELEVATION: integer (nullable = true)\n |-- HYDR_AREA_ID: integer (nullable = true)\n |-- DRAI: integer (nullable = true)\n |-- SRC_BGN_DA: string (nullable = true)\n |-- SRC_END_DA: string (nullable = true)\n\n+------+--------+----+------+--------+----------+----------+----+---------+-------------+-------------+----+-------------+--------------+---------+------------+----+----------+----------+\n|SRC_ID|SRC_NAME|ID_T|    ID|MET_DOMA|SRC_CAP_BG|SRC_CAP_EN|LOC_|POST_CODE|HIGH_PRCN_LAT|HIGH_PRCN_LON|GRID|EAST_GRID_REF|NORTH_GRID_REF|ELEVATION|HYDR_AREA_ID|DRAI|SRC_BGN_DA|SRC_END_DA|\n+------+--------+----+------+--------+----------+----------+----+---------+-------------+-------------+----+-------------+--------------+---------+------------+----+----------+----------+\n|   708|HEATHROW|RAIN|247536|   CLMSN|01/01/1961|31/12/1990| GLN|    TW6 2|       51.479|       -0.449|  OS|       507700|        176700|       25|         391| 200|01/01/1947|31/12/3999|\n|   708|HEATHROW| WMO|  3772|CLM71-06|01/01/1997|31/12/3999| GLN|    TW6 2|       51.479|       -0.449|  OS|       507700|        176700|       25|         391| 200|01/01/1947|31/12/3999|\n|   708|HEATHROW|DCNN|  5113|HSUN3445|01/01/1980|31/12/2004| GLN|    TW6 2|       51.479|       -0.449|  OS|       507700|        176700|       25|         391| 200|01/01/1947|31/12/3999|\n|   708|HEATHROW|WIND|511302|HWNDAUTO|01/02/1981|31/12/1982| GLN|    TW6 2|       51.479|       -0.449|  OS|       507700|        176700|       25|         391| 200|01/01/1947|31/12/3999|\n|   708|HEATHROW|WIND|511302|HWND6910|01/02/1981|31/12/1982| GLN|    TW6 2|       51.479|       -0.449|  OS|       507700|        176700|       25|         391| 200|01/01/1947|31/12/3999|\n|   708|HEATHROW|RAIN|247539|    SREW|01/05/2003|31/12/3999| GLN|    TW6 2|       51.479|       -0.449|  OS|       507700|        176700|       25|         391| 200|01/01/1947|31/12/3999|\n|   708|HEATHROW|WIND|511305|     HCM|01/12/2003|31/12/3999| GLN|    TW6 2|       51.479|       -0.449|  OS|       507700|        176700|       25|         391| 200|01/01/1947|31/12/3999|\n|   708|HEATHROW|WIND|511301|HWND6910|01/01/1949|31/03/1973| GLN|    TW6 2|       51.479|       -0.449|  OS|       507700|        176700|       25|         391| 200|01/01/1947|31/12/3999|\n|   708|HEATHROW| WMO|  3772|     HCM|11/09/2002|31/12/3999| GLN|    TW6 2|       51.479|       -0.449|  OS|       507700|        176700|       25|         391| 200|01/01/1947|31/12/3999|\n|   708|HEATHROW|WIND|511304|     HCM|11/09/2002|01/12/2003| GLN|    TW6 2|       51.479|       -0.449|  OS|       507700|        176700|       25|         391| 200|01/01/1947|31/12/3999|\n|   708|HEATHROW|DCNN|  5113|   SYNOP|01/08/2001|31/12/3999| GLN|    TW6 2|       51.479|       -0.449|  OS|       507700|        176700|       25|         391| 200|01/01/1947|31/12/3999|\n|   708|HEATHROW| WMO|  3772|   CLM71|01/01/1961|31/12/1990| GLN|    TW6 2|       51.479|       -0.449|  OS|       507700|        176700|       25|         391| 200|01/01/1947|31/12/3999|\n|   708|HEATHROW|DCNN|  5113|  CARLOS|01/01/1947|31/12/3999| GLN|    TW6 2|       51.479|       -0.449|  OS|       507700|        176700|       25|         391| 200|01/01/1947|31/12/3999|\n|   708|HEATHROW|RAIN|247536| WAHRAIN|01/01/1949|31/07/1988| GLN|    TW6 2|       51.479|       -0.449|  OS|       507700|        176700|       25|         391| 200|01/01/1947|31/12/3999|\n|   708|HEATHROW|RAIN|247536| WADRAIN|01/04/1997|31/12/3999| GLN|    TW6 2|       51.479|       -0.449|  OS|       507700|        176700|       25|         391| 200|01/01/1947|31/12/3999|\n|   708|HEATHROW| WMO|  3772|   SYNOP|01/01/1947|31/12/3999| GLN|    TW6 2|       51.479|       -0.449|  OS|       507700|        176700|       25|         391| 200|01/01/1947|31/12/3999|\n|   708|HEATHROW|RAIN|247537|    SSER|01/08/1988|30/04/2003| GLN|    TW6 2|       51.479|       -0.449|  OS|       507700|        176700|       25|         391| 200|01/01/1947|31/12/3999|\n|   708|HEATHROW|RAIN|247536|    SREW|01/01/1980|31/01/1984| GLN|    TW6 2|       51.479|       -0.449|  OS|       507700|        176700|       25|         391| 200|01/01/1947|31/12/3999|\n|   708|HEATHROW|RAIN|247536|    SREW|01/01/1993|30/06/1997| GLN|    TW6 2|       51.479|       -0.449|  OS|       507700|        176700|       25|         391| 200|01/01/1947|31/12/3999|\n|   708|HEATHROW| WMO|  3772|    SREW|01/01/1994|31/12/3999| GLN|    TW6 2|       51.479|       -0.449|  OS|       507700|        176700|       25|         391| 200|01/01/1947|31/12/3999|\n+------+--------+----+------+--------+----------+----------+----+---------+-------------+-------------+----+-------------+--------------+---------+------------+----+----------+----------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1522956754877_1887585764","id":"20180405-160202_1420526087","dateCreated":"2018-04-05T19:32:34+0000","dateStarted":"2018-04-05T19:34:43+0000","dateFinished":"2018-04-05T19:35:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:258"},{"text":"%pyspark\n\nfrom pyspark.sql.types import StructType, StructField, StringType\n\nwxhrly_schema = StructType([\\\n    StructField(\"ob_time\", StringType(), True),\\\n    StructField(\"id\", StringType(), True),\\\n    StructField(\"id_type\", StringType(), True),\\\n    StructField(\"met_domain_name\", StringType(), True),\\\n    StructField(\"version_num\", StringType(), True),\\\n    StructField(\"src_id\", StringType(), True),\\\n    StructField(\"rec_st_ind\", StringType(), True),\\\n    StructField(\"wind_speed_unit_id\", StringType(), True),\\\n    StructField(\"src_opr_type\", StringType(), True),\\\n    StructField(\"wind_direction\", StringType(), True),\\\n    StructField(\"wind_speed\", StringType(), True),\\\n    StructField(\"prst_wx_id\", StringType(), True),\\\n    StructField(\"past_wx_id_1\", StringType(), True),\\\n    StructField(\"past_wx_id_2\", StringType(), True),\\\n    StructField(\"cld_ttl_amt_id\", StringType(), True),\\\n    StructField(\"low_cld_type_id\", StringType(), True),\\\n    StructField(\"med_cld_type_id\", StringType(), True),\\\n    StructField(\"hi_cld_type_id\", StringType(), True),\\\n    StructField(\"cld_base_amt_id\", StringType(), True),\\\n    StructField(\"cld_base_ht\", StringType(), True),\\\n    StructField(\"visibility\", StringType(), True),\\\n    StructField(\"msl_pressure\", StringType(), True),\\\n    StructField(\"cld_amt_id_1\", StringType(), True),\\\n    StructField(\"cloud_type_id_1\", StringType(), True),\\\n    StructField(\"cld_base_ht_id_1\", StringType(), True),\\\n    StructField(\"cld_amt_id_2\", StringType(), True),\\\n    StructField(\"cloud_type_id_2\", StringType(), True),\\\n    StructField(\"cld_base_ht_id_2\", StringType(), True),\\\n    StructField(\"cld_amt_id_3\", StringType(), True),\\\n    StructField(\"cloud_type_id_3\", StringType(), True),\\\n    StructField(\"cld_base_ht_id_3\", StringType(), True),\\\n    StructField(\"cld_amt_id_4\", StringType(), True),\\\n    StructField(\"cloud_type_id_4\", StringType(), True),\\\n    StructField(\"cld_base_ht_id_4\", StringType(), True),\\\n    StructField(\"vert_vsby\", StringType(), True),\\\n    StructField(\"air_temperature\", StringType(), True),\\\n    StructField(\"dewpoint\", StringType(), True),\\\n    StructField(\"wetb_temp\", StringType(), True),\\\n    StructField(\"stn_pres\", StringType(), True),\\\n    StructField(\"alt_pres\", StringType(), True),\\\n    StructField(\"ground_state_id\", StringType(), True),\\\n    StructField(\"q10mnt_mxgst_spd\", StringType(), True),\\\n    StructField(\"cavok_flag\", StringType(), True),\\\n    StructField(\"cs_hr_sun_dur\", StringType(), True),\\\n    StructField(\"wmo_hr_sun_dur\", StringType(), True),\\\n    StructField(\"wind_direction_q\", StringType(), True),\\\n    StructField(\"wind_speed_q\", StringType(), True),\\\n    StructField(\"prst_wx_id_q\", StringType(), True),\\\n    StructField(\"past_wx_id_1_q\", StringType(), True),\\\n    StructField(\"past_wx_id_2_q\", StringType(), True),\\\n    StructField(\"cld_ttl_amt_id_q\", StringType(), True),\\\n    StructField(\"low_cld_type_id_q\", StringType(), True),\\\n    StructField(\"med_cld_type_id_q\", StringType(), True),\\\n    StructField(\"hi_cld_type_id_q\", StringType(), True),\\\n    StructField(\"cld_base_amt_id_q\", StringType(), True),\\\n    StructField(\"cld_base_ht_q\", StringType(), True),\\\n    StructField(\"visibility_q\", StringType(), True),\\\n    StructField(\"msl_pressure_q\", StringType(), True),\\\n    StructField(\"air_temperature_q\", StringType(), True),\\\n    StructField(\"dewpoint_q\", StringType(), True),\\\n    StructField(\"wetb_temp_q\", StringType(), True),\\\n    StructField(\"ground_state_id_q\", StringType(), True),\\\n    StructField(\"cld_amt_id_1_q\", StringType(), True),\\\n    StructField(\"cloud_type_id_1_q\", StringType(), True),\\\n    StructField(\"cld_base_ht_id_1_q\", StringType(), True),\\\n    StructField(\"cld_amt_id_2_q\", StringType(), True),\\\n    StructField(\"cloud_type_id_2_q\", StringType(), True),\\\n    StructField(\"cld_base_ht_id_2_q\", StringType(), True),\\\n    StructField(\"cld_amt_id_3_q\", StringType(), True),\\\n    StructField(\"cloud_type_id_3_q\", StringType(), True),\\\n    StructField(\"cld_base_ht_id_3_q\", StringType(), True),\\\n    StructField(\"cld_amt_id_4_q\", StringType(), True),\\\n    StructField(\"cloud_type_id_4_q\", StringType(), True),\\\n    StructField(\"cld_base_ht_id_4_q\", StringType(), True),\\\n    StructField(\"vert_vsby_q\", StringType(), True),\\\n    StructField(\"stn_pres_q\", StringType(), True),\\\n    StructField(\"alt_pres_q\", StringType(), True),\\\n    StructField(\"q10mnt_mxgst_spd_q\", StringType(), True),\\\n    StructField(\"cs_hr_sun_dur_q\", StringType(), True),\\\n    StructField(\"wmo_hr_sun_dur_q\", StringType(), True),\\\n    StructField(\"meto_stmp_time\", StringType(), True),\\\n    StructField(\"midas_stmp_etime\", StringType(), True),\\\n    StructField(\"wind_direction_j\", StringType(), True),\\\n    StructField(\"wind_speed_j\", StringType(), True),\\\n    StructField(\"prst_wx_id_j\", StringType(), True),\\\n    StructField(\"past_wx_id_1_j\", StringType(), True),\\\n    StructField(\"past_wx_id_2_j\", StringType(), True),\\\n    StructField(\"cld_amt_id_j\", StringType(), True),\\\n    StructField(\"cld_ht_j\", StringType(), True),\\\n    StructField(\"visibility_j\", StringType(), True),\\\n    StructField(\"msl_pressure_j\", StringType(), True),\\\n    StructField(\"air_temperature_j\", StringType(), True),\\\n    StructField(\"dewpoint_j\", StringType(), True),\\\n    StructField(\"wetb_temp_j\", StringType(), True),\\\n    StructField(\"vert_vsby_j\", StringType(), True),\\\n    StructField(\"stn_pres_j\", StringType(), True),\\\n    StructField(\"alt_pres_j\", StringType(), True),\\\n    StructField(\"q10mnt_mxgst_spd_j\", StringType(), True),\\\n    StructField(\"rltv_hum\", StringType(), True),\\\n    StructField(\"rltv_hum_j\", StringType(), True),\\\n    StructField(\"snow_depth\", StringType(), True),\\\n    StructField(\"snow_depth_q\", StringType(), True),\\\n    StructField(\"drv_hr_sun_dur\", StringType(), True),\\\n    StructField(\"drv_hr_sun_dur_q\", StringType(), True)\\\n])\n\nrainhrly_schema = StructType([\\\n    StructField(\"ob_end_time\", StringType(), True),\\\n    StructField(\"id\", StringType(), True),\\\n    StructField(\"id_type\", StringType(), True),\\\n    StructField(\"ob_hour_count\", StringType(), True),\\\n    StructField(\"version_num\", StringType(), True),\\\n    StructField(\"met_domain_name\", StringType(), True),\\\n    StructField(\"src_id\", StringType(), True),\\\n    StructField(\"rec_st_ind\", StringType(), True),\\\n    StructField(\"prcp_amt\", StringType(), True),\\\n    StructField(\"prcp_dur\", StringType(), True),\\\n    StructField(\"prcp_amt_q\", StringType(), True),\\\n    StructField(\"prcp_dur_q\", StringType(), True),\\\n    StructField(\"meto_stmp_time\", StringType(), True),\\\n    StructField(\"midas_stmp_etime\", StringType(), True),\\\n    StructField(\"prcp_amt_j\", StringType(), True)\\\n])","user":"anonymous","dateUpdated":"2018-04-05T19:34:43+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1522956754877_1887585764","id":"20180405-164946_454462664","dateCreated":"2018-04-05T19:32:34+0000","dateStarted":"2018-04-05T19:34:43+0000","dateFinished":"2018-04-05T19:35:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:259"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2018-04-05T19:34:43+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1522956754877_1887585764","id":"20180405-175459_1380855464","dateCreated":"2018-04-05T19:32:34+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:260"},{"text":"%pyspark\n\n# only get heathrow data (708)\nwxhrly_df = spark.read.csv(\"\".join([\"s3a://\", s3_bucket, weather_path, wxhrly_raw]),\\\n                           header=\"false\",\\\n                           inferSchema=\"false\",\\\n                           schema=wxhrly_schema,\\\n                           dateFormat=\"yyyy-MM-dd\",\\\n                           timestampFormat=\"yyyy-MM-dd HH:mm\",\\\n                           sep=\",\")\\\n                      .filter(\"src_id = ' 708'\")\n\nif debug:\n    wxhrly_df.printSchema()\n    wxhrly_df.show()","user":"anonymous","dateUpdated":"2018-04-05T19:34:43+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- ob_time: string (nullable = true)\n |-- id: string (nullable = true)\n |-- id_type: string (nullable = true)\n |-- met_domain_name: string (nullable = true)\n |-- version_num: string (nullable = true)\n |-- src_id: string (nullable = true)\n |-- rec_st_ind: string (nullable = true)\n |-- wind_speed_unit_id: string (nullable = true)\n |-- src_opr_type: string (nullable = true)\n |-- wind_direction: string (nullable = true)\n |-- wind_speed: string (nullable = true)\n |-- prst_wx_id: string (nullable = true)\n |-- past_wx_id_1: string (nullable = true)\n |-- past_wx_id_2: string (nullable = true)\n |-- cld_ttl_amt_id: string (nullable = true)\n |-- low_cld_type_id: string (nullable = true)\n |-- med_cld_type_id: string (nullable = true)\n |-- hi_cld_type_id: string (nullable = true)\n |-- cld_base_amt_id: string (nullable = true)\n |-- cld_base_ht: string (nullable = true)\n |-- visibility: string (nullable = true)\n |-- msl_pressure: string (nullable = true)\n |-- cld_amt_id_1: string (nullable = true)\n |-- cloud_type_id_1: string (nullable = true)\n |-- cld_base_ht_id_1: string (nullable = true)\n |-- cld_amt_id_2: string (nullable = true)\n |-- cloud_type_id_2: string (nullable = true)\n |-- cld_base_ht_id_2: string (nullable = true)\n |-- cld_amt_id_3: string (nullable = true)\n |-- cloud_type_id_3: string (nullable = true)\n |-- cld_base_ht_id_3: string (nullable = true)\n |-- cld_amt_id_4: string (nullable = true)\n |-- cloud_type_id_4: string (nullable = true)\n |-- cld_base_ht_id_4: string (nullable = true)\n |-- vert_vsby: string (nullable = true)\n |-- air_temperature: string (nullable = true)\n |-- dewpoint: string (nullable = true)\n |-- wetb_temp: string (nullable = true)\n |-- stn_pres: string (nullable = true)\n |-- alt_pres: string (nullable = true)\n |-- ground_state_id: string (nullable = true)\n |-- q10mnt_mxgst_spd: string (nullable = true)\n |-- cavok_flag: string (nullable = true)\n |-- cs_hr_sun_dur: string (nullable = true)\n |-- wmo_hr_sun_dur: string (nullable = true)\n |-- wind_direction_q: string (nullable = true)\n |-- wind_speed_q: string (nullable = true)\n |-- prst_wx_id_q: string (nullable = true)\n |-- past_wx_id_1_q: string (nullable = true)\n |-- past_wx_id_2_q: string (nullable = true)\n |-- cld_ttl_amt_id_q: string (nullable = true)\n |-- low_cld_type_id_q: string (nullable = true)\n |-- med_cld_type_id_q: string (nullable = true)\n |-- hi_cld_type_id_q: string (nullable = true)\n |-- cld_base_amt_id_q: string (nullable = true)\n |-- cld_base_ht_q: string (nullable = true)\n |-- visibility_q: string (nullable = true)\n |-- msl_pressure_q: string (nullable = true)\n |-- air_temperature_q: string (nullable = true)\n |-- dewpoint_q: string (nullable = true)\n |-- wetb_temp_q: string (nullable = true)\n |-- ground_state_id_q: string (nullable = true)\n |-- cld_amt_id_1_q: string (nullable = true)\n |-- cloud_type_id_1_q: string (nullable = true)\n |-- cld_base_ht_id_1_q: string (nullable = true)\n |-- cld_amt_id_2_q: string (nullable = true)\n |-- cloud_type_id_2_q: string (nullable = true)\n |-- cld_base_ht_id_2_q: string (nullable = true)\n |-- cld_amt_id_3_q: string (nullable = true)\n |-- cloud_type_id_3_q: string (nullable = true)\n |-- cld_base_ht_id_3_q: string (nullable = true)\n |-- cld_amt_id_4_q: string (nullable = true)\n |-- cloud_type_id_4_q: string (nullable = true)\n |-- cld_base_ht_id_4_q: string (nullable = true)\n |-- vert_vsby_q: string (nullable = true)\n |-- stn_pres_q: string (nullable = true)\n |-- alt_pres_q: string (nullable = true)\n |-- q10mnt_mxgst_spd_q: string (nullable = true)\n |-- cs_hr_sun_dur_q: string (nullable = true)\n |-- wmo_hr_sun_dur_q: string (nullable = true)\n |-- meto_stmp_time: string (nullable = true)\n |-- midas_stmp_etime: string (nullable = true)\n |-- wind_direction_j: string (nullable = true)\n |-- wind_speed_j: string (nullable = true)\n |-- prst_wx_id_j: string (nullable = true)\n |-- past_wx_id_1_j: string (nullable = true)\n |-- past_wx_id_2_j: string (nullable = true)\n |-- cld_amt_id_j: string (nullable = true)\n |-- cld_ht_j: string (nullable = true)\n |-- visibility_j: string (nullable = true)\n |-- msl_pressure_j: string (nullable = true)\n |-- air_temperature_j: string (nullable = true)\n |-- dewpoint_j: string (nullable = true)\n |-- wetb_temp_j: string (nullable = true)\n |-- vert_vsby_j: string (nullable = true)\n |-- stn_pres_j: string (nullable = true)\n |-- alt_pres_j: string (nullable = true)\n |-- q10mnt_mxgst_spd_j: string (nullable = true)\n |-- rltv_hum: string (nullable = true)\n |-- rltv_hum_j: string (nullable = true)\n |-- snow_depth: string (nullable = true)\n |-- snow_depth_q: string (nullable = true)\n |-- drv_hr_sun_dur: string (nullable = true)\n |-- drv_hr_sun_dur_q: string (nullable = true)\n\n+----------------+------+-------+---------------+-----------+------+----------+------------------+------------+--------------+----------+----------+------------+------------+--------------+---------------+---------------+--------------+---------------+-----------+----------+------------+------------+---------------+----------------+------------+---------------+----------------+------------+---------------+----------------+------------+---------------+----------------+---------+---------------+--------+---------+--------+--------+---------------+----------------+----------+-------------+--------------+----------------+------------+------------+--------------+--------------+----------------+-----------------+-----------------+----------------+-----------------+-------------+------------+--------------+-----------------+----------+-----------+-----------------+--------------+-----------------+------------------+--------------+-----------------+------------------+--------------+-----------------+------------------+--------------+-----------------+------------------+-----------+----------+----------+------------------+---------------+----------------+-----------------+----------------+----------------+------------+------------+--------------+--------------+------------+--------+------------+--------------+-----------------+----------+-----------+-----------+----------+----------+------------------+--------+----------+----------+------------+--------------+----------------+\n|         ob_time|    id|id_type|met_domain_name|version_num|src_id|rec_st_ind|wind_speed_unit_id|src_opr_type|wind_direction|wind_speed|prst_wx_id|past_wx_id_1|past_wx_id_2|cld_ttl_amt_id|low_cld_type_id|med_cld_type_id|hi_cld_type_id|cld_base_amt_id|cld_base_ht|visibility|msl_pressure|cld_amt_id_1|cloud_type_id_1|cld_base_ht_id_1|cld_amt_id_2|cloud_type_id_2|cld_base_ht_id_2|cld_amt_id_3|cloud_type_id_3|cld_base_ht_id_3|cld_amt_id_4|cloud_type_id_4|cld_base_ht_id_4|vert_vsby|air_temperature|dewpoint|wetb_temp|stn_pres|alt_pres|ground_state_id|q10mnt_mxgst_spd|cavok_flag|cs_hr_sun_dur|wmo_hr_sun_dur|wind_direction_q|wind_speed_q|prst_wx_id_q|past_wx_id_1_q|past_wx_id_2_q|cld_ttl_amt_id_q|low_cld_type_id_q|med_cld_type_id_q|hi_cld_type_id_q|cld_base_amt_id_q|cld_base_ht_q|visibility_q|msl_pressure_q|air_temperature_q|dewpoint_q|wetb_temp_q|ground_state_id_q|cld_amt_id_1_q|cloud_type_id_1_q|cld_base_ht_id_1_q|cld_amt_id_2_q|cloud_type_id_2_q|cld_base_ht_id_2_q|cld_amt_id_3_q|cloud_type_id_3_q|cld_base_ht_id_3_q|cld_amt_id_4_q|cloud_type_id_4_q|cld_base_ht_id_4_q|vert_vsby_q|stn_pres_q|alt_pres_q|q10mnt_mxgst_spd_q|cs_hr_sun_dur_q|wmo_hr_sun_dur_q|   meto_stmp_time|midas_stmp_etime|wind_direction_j|wind_speed_j|prst_wx_id_j|past_wx_id_1_j|past_wx_id_2_j|cld_amt_id_j|cld_ht_j|visibility_j|msl_pressure_j|air_temperature_j|dewpoint_j|wetb_temp_j|vert_vsby_j|stn_pres_j|alt_pres_j|q10mnt_mxgst_spd_j|rltv_hum|rltv_hum_j|snow_depth|snow_depth_q|drv_hr_sun_dur|drv_hr_sun_dur_q|\n+----------------+------+-------+---------------+-----------+------+----------+------------------+------------+--------------+----------+----------+------------+------------+--------------+---------------+---------------+--------------+---------------+-----------+----------+------------+------------+---------------+----------------+------------+---------------+----------------+------------+---------------+----------------+------------+---------------+----------------+---------+---------------+--------+---------+--------+--------+---------------+----------------+----------+-------------+--------------+----------------+------------+------------+--------------+--------------+----------------+-----------------+-----------------+----------------+-----------------+-------------+------------+--------------+-----------------+----------+-----------+-----------------+--------------+-----------------+------------------+--------------+-----------------+------------------+--------------+-----------------+------------------+--------------+-----------------+------------------+-----------+----------+----------+------------------+---------------+----------------+-----------------+----------------+----------------+------------+------------+--------------+--------------+------------+--------+------------+--------------+-----------------+----------+-----------+-----------+----------+----------+------------------+--------+----------+----------+------------+--------------+----------------+\n|2012-01-01 00:00| 03772|    WMO|          SYNOP|          1|   708|      1011|                 4|           7|           220|        13|        23|            |            |             8|               |               |              |               |         30|      3500|      1008.1|           8|               |              36|            |               |                |            |               |                |            |               |                |         |           12.2|    10.7|     11.4|  1005.1|    1008|               |                |         8|             |              |               1|           1|           1|              |              |               1|                 |                 |                |                 |            1|           1|             1|                1|         1|          1|                 |             1|                 |                 1|              |                 |                  |              |                 |                  |              |                 |                  |           |         1|         1|                  |               |                | 2011-12-31 23:52|               0|                |            |            |              |              |            |        |            |              |                 |          |          K|           |          |          |                  |    90.3|         A|          |            |             0|               1|\n|2012-01-01 00:00| 03772|    WMO|          SYNOP|          1|   708|      1011|                 4|           7|           220|        13|        23|            |            |             8|               |               |              |               |         30|      3500|      1008.1|           8|               |              36|            |               |                |            |               |                |            |               |                |         |           12.2|    10.7|     11.4|  1005.1|    1008|               |                |         8|             |              |               6|           6|           6|              |              |               6|                 |                 |                |                 |            6|           6|             6|                6|         6|          6|                 |             6|                 |                 6|              |                 |                  |              |                 |                  |              |                 |                  |           |         6|         1|                  |               |                | 2011-12-31 23:52|               0|                |            |            |              |              |            |        |            |              |                 |          |          K|           |          |          |                  |    90.3|         A|          |            |             0|               1|\n|2012-01-01 01:00| 03772|    WMO|          SYNOP|          1|   708|      1011|                 4|           5|           240|        15|          |            |            |             8|               |               |              |               |         30|      2900|        1008|           8|               |              36|            |               |                |            |               |                |            |               |                |         |           12.4|    10.7|     11.5|    1005|    1007|               |                |         8|             |             0|               1|           1|            |              |              |               1|                 |                 |                |                 |            1|           1|             1|                1|         1|          1|                 |             1|                 |                 1|              |                 |                  |              |                 |                  |              |                 |                  |           |         1|         1|                  |               |               1| 2012-01-01 00:52|               0|                |            |            |              |              |            |        |            |              |                 |          |          K|           |          |          |                  |    89.2|         A|          |            |             0|               1|\n|2012-01-01 01:00| 03772|    WMO|          SYNOP|          1|   708|      1011|                 4|           5|           240|        15|          |            |            |             8|               |               |              |               |         30|      2900|        1008|           8|               |              36|            |               |                |            |               |                |            |               |                |         |           12.4|    10.7|     11.5|    1005|    1007|               |                |         8|             |             0|               6|           6|            |              |              |               6|                 |                 |                |                 |            6|           6|             6|                6|         6|          6|                 |             6|                 |                 6|              |                 |                  |              |                 |                  |              |                 |                  |           |         6|         1|                  |               |               6| 2012-01-01 00:52|               0|                |            |            |              |              |            |        |            |              |                 |          |          K|           |          |          |                  |    89.2|         A|          |            |             0|               1|\n|2012-01-01 02:00| 03772|    WMO|          SYNOP|          1|   708|      1011|                 4|           7|           220|        12|        51|            |            |             8|               |               |              |               |         30|      1500|        1008|           5|               |              36|           5|               |             180|            |               |                |            |               |                |         |           11.9|    10.9|     11.4|  1004.9|    1008|               |                |         8|             |             0|               1|           1|           1|              |              |               1|                 |                 |                |                 |            1|           1|             1|                1|         1|          1|                 |             1|                 |                 1|             1|                 |                 1|              |                 |                  |              |                 |                  |           |         1|         1|                  |               |               1| 2012-01-01 01:52|               0|                |            |            |              |              |            |        |            |              |                 |          |          K|           |          |          |                  |    93.8|         A|          |            |             0|               1|\n|2012-01-01 02:00| 03772|    WMO|          SYNOP|          1|   708|      1011|                 4|           7|           220|        12|        51|            |            |             8|               |               |              |               |         30|      1500|        1008|           5|               |              36|           5|               |             180|            |               |                |            |               |                |         |           11.9|    10.9|     11.4|  1004.9|    1008|               |                |         8|             |             0|               6|           6|           6|              |              |               6|                 |                 |                |                 |            6|           6|             6|                6|         6|          6|                 |             6|                 |                 6|             6|                 |                 6|              |                 |                  |              |                 |                  |           |         6|         1|                  |               |               6| 2012-01-01 01:52|               0|                |            |            |              |              |            |        |            |              |                 |          |          K|           |          |          |                  |    93.8|         A|          |            |             0|               1|\n|2012-01-01 03:00| 03772|    WMO|          SYNOP|          1|   708|      1011|                 4|           7|           220|        12|        22|            |            |             7|               |               |              |               |         30|      4000|      1007.7|           5|               |              48|           5|               |             420|            |               |                |            |               |                |         |           11.8|    10.7|     11.2|  1004.7|    1007|               |                |         8|             |             0|               1|           1|           1|              |              |               1|                 |                 |                |                 |            1|           1|             1|                1|         1|          1|                 |             1|                 |                 1|             1|                 |                 1|              |                 |                  |              |                 |                  |           |         1|         1|                  |               |               1| 2012-01-01 02:53|               0|                |            |            |              |              |            |        |            |              |                 |          |          K|           |          |          |                  |    92.6|         A|          |            |             0|               1|\n|2012-01-01 03:00| 03772|    WMO|          SYNOP|          1|   708|      1011|                 4|           7|           220|        12|        22|            |            |             7|               |               |              |               |         30|      4000|      1007.7|           5|               |              48|           5|               |             420|            |               |                |            |               |                |         |           11.8|    10.7|     11.2|  1004.7|    1007|               |                |         8|             |             0|               6|           6|           6|              |              |               6|                 |                 |                |                 |            6|           6|             6|                6|         6|          6|                 |             6|                 |                 6|             6|                 |                 6|              |                 |                  |              |                 |                  |           |         6|         1|                  |               |               6| 2012-01-01 02:53|               0|                |            |            |              |              |            |        |            |              |                 |          |          K|           |          |          |                  |    92.6|         A|          |            |             0|               1|\n|2012-01-01 04:00| 03772|    WMO|          SYNOP|          1|   708|      1011|                 4|           5|           220|         9|          |            |            |             4|               |               |              |               |        250|      3500|      1007.6|           4|               |             420|            |               |                |            |               |                |            |               |                |         |           11.7|    10.4|       11|  1004.5|    1008|               |                |         8|             |             0|               1|           1|            |              |              |               1|                 |                 |                |                 |            1|           1|             1|                1|         1|          1|                 |             1|                 |                 1|              |                 |                  |              |                 |                  |              |                 |                  |           |         1|         1|                  |               |               1| 2012-01-01 03:52|               0|                |            |            |              |              |            |        |            |              |                 |          |          K|           |          |          |                  |    91.4|         A|          |            |             0|               1|\n|2012-01-01 04:00| 03772|    WMO|          SYNOP|          1|   708|      1011|                 4|           5|           220|         9|          |            |            |             4|               |               |              |               |        250|      3500|      1007.6|           4|               |             420|            |               |                |            |               |                |            |               |                |         |           11.7|    10.4|       11|  1004.5|    1008|               |                |         8|             |             0|               6|           6|            |              |              |               6|                 |                 |                |                 |            6|           6|             6|                6|         6|          6|                 |             6|                 |                 6|              |                 |                  |              |                 |                  |              |                 |                  |           |         6|         1|                  |               |               6| 2012-01-01 03:52|               0|                |            |            |              |              |            |        |            |              |                 |          |          K|           |          |          |                  |    91.4|         A|          |            |             0|               1|\n|2012-01-01 05:00| 03772|    WMO|          SYNOP|          1|   708|      1011|                 4|           5|           220|        11|          |            |            |             7|               |               |              |               |         60|      4000|      1007.5|           6|               |              78|           4|               |             480|            |               |                |            |               |                |         |           11.9|    10.4|     11.1|  1004.4|    1007|               |                |         8|             |             0|               1|           1|            |              |              |               1|                 |                 |                |                 |            1|           1|             1|                1|         1|          1|                 |             1|                 |                 1|             1|                 |                 1|              |                 |                  |              |                 |                  |           |         1|         1|                  |               |               1| 2012-01-01 04:52|               0|                |            |            |              |              |            |        |            |              |                 |          |          K|           |          |          |                  |    90.2|         A|          |            |             0|               1|\n|2012-01-01 05:00| 03772|    WMO|          SYNOP|          1|   708|      1011|                 4|           5|           220|        11|          |            |            |             7|               |               |              |               |         60|      4000|      1007.5|           6|               |              78|           4|               |             480|            |               |                |            |               |                |         |           11.9|    10.4|     11.1|  1004.4|    1007|               |                |         8|             |             0|               6|           6|            |              |              |               6|                 |                 |                |                 |            6|           6|             6|                6|         6|          6|                 |             6|                 |                 6|             6|                 |                 6|              |                 |                  |              |                 |                  |           |         6|         1|                  |               |               6| 2012-01-01 04:52|               0|                |            |            |              |              |            |        |            |              |                 |          |          K|           |          |          |                  |    90.2|         A|          |            |             0|               1|\n|2012-01-01 06:00| 03772|    WMO|          SYNOP|          1|   708|      1011|                 4|           5|           210|        12|          |            |            |             8|               |               |              |               |        100|      3000|      1007.4|           2|               |              93|           6|               |             117|            |               |                |            |               |                |         |           11.9|    10.3|     11.1|  1004.4|    1007|               |                |         8|             |             0|               1|           1|            |              |              |               1|                 |                 |                |                 |            1|           1|             1|                1|         1|          1|                 |             1|                 |                 1|             1|                 |                 1|              |                 |                  |              |                 |                  |           |         1|         1|                  |               |               1| 2012-01-01 05:53|               0|                |            |            |              |              |            |        |            |              |                 |          |          K|           |          |          |                  |    90.2|         A|          |            |             0|               1|\n|2012-01-01 06:00| 03772|    WMO|          SYNOP|          1|   708|      1011|                 4|           5|           210|        12|          |            |            |             8|               |               |              |               |        100|      3000|      1007.4|           2|               |              93|           6|               |             117|            |               |                |            |               |                |         |           11.9|    10.3|     11.1|  1004.4|    1007|               |                |         8|             |             0|               6|           6|            |              |              |               6|                 |                 |                |                 |            6|           6|             6|                6|         6|          6|                 |             6|                 |                 6|             6|                 |                 6|              |                 |                  |              |                 |                  |           |         6|         1|                  |               |               6| 2012-01-01 05:53|               0|                |            |            |              |              |            |        |            |              |                 |          |          K|           |          |          |                  |    90.2|         A|          |            |             0|               1|\n|2012-01-01 07:00| 03772|    WMO|          SYNOP|          1|   708|      1011|                 4|           5|           220|        10|          |            |            |             7|               |               |              |               |        100|      3000|      1007.1|           4|               |              99|           3|               |             720|            |               |                |            |               |                |         |           11.8|     9.8|     10.8|  1004.1|    1007|               |                |         8|             |             0|               1|           1|            |              |              |               1|                 |                 |                |                 |            1|           1|             1|                1|         1|          1|                 |             1|                 |                 1|             1|                 |                 1|              |                 |                  |              |                 |                  |           |         1|         1|                  |               |               1| 2012-01-01 06:52|               0|                |            |            |              |              |            |        |            |              |                 |          |          K|           |          |          |                  |    87.8|         A|          |            |             0|               1|\n|2012-01-01 07:00| 03772|    WMO|          SYNOP|          1|   708|      1011|                 4|           5|           220|        10|          |            |            |             7|               |               |              |               |        100|      3000|      1007.1|           4|               |              99|           3|               |             720|            |               |                |            |               |                |         |           11.8|     9.8|     10.8|  1004.1|    1007|               |                |         8|             |             0|               6|           6|            |              |              |               6|                 |                 |                |                 |            6|           6|             6|                6|         6|          6|                 |             6|                 |                 6|             6|                 |                 6|              |                 |                  |              |                 |                  |           |         6|         1|                  |               |               6| 2012-01-01 06:52|               0|                |            |            |              |              |            |        |            |              |                 |          |          K|           |          |          |                  |    87.8|         A|          |            |             0|               1|\n|2012-01-01 08:00| 03772|    WMO|          SYNOP|          1|   708|      1011|                 4|           5|           210|        11|          |            |            |             7|               |               |              |               |         60|      3000|      1007.2|           2|               |              69|           4|               |             117|            |               |                |            |               |                |         |           11.7|     9.6|     10.6|  1004.2|    1007|               |                |         8|             |             0|               1|           1|            |              |              |               1|                 |                 |                |                 |            1|           1|             1|                1|         1|          1|                 |             1|                 |                 1|             1|                 |                 1|              |                 |                  |              |                 |                  |           |         1|         1|                  |               |               1| 2012-01-01 07:52|               0|                |            |            |              |              |            |        |            |              |                 |          |          K|           |          |          |                  |    86.5|         A|          |            |             0|               1|\n|2012-01-01 08:00| 03772|    WMO|          SYNOP|          1|   708|      1011|                 4|           5|           210|        11|          |            |            |             7|               |               |              |               |         60|      3000|      1007.2|           2|               |              69|           4|               |             117|            |               |                |            |               |                |         |           11.7|     9.6|     10.6|  1004.2|    1007|               |                |         8|             |             0|               6|           6|            |              |              |               6|                 |                 |                |                 |            6|           6|             6|                6|         6|          6|                 |             6|                 |                 6|             6|                 |                 6|              |                 |                  |              |                 |                  |           |         6|         1|                  |               |               6| 2012-01-01 07:52|               0|                |            |            |              |              |            |        |            |              |                 |          |          K|           |          |          |                  |    86.5|         A|          |            |             0|               1|\n|2012-01-01 09:00| 03772|    WMO|          SYNOP|          1|   708|      1011|                 4|           5|           210|        11|          |            |            |             6|               |               |              |               |         30|      3000|      1006.8|           4|               |              45|            |               |                |            |               |                |            |               |                |         |           11.6|     9.5|     10.5|  1003.8|    1007|               |                |         8|             |             0|               1|           1|            |              |              |               1|                 |                 |                |                 |            1|           1|             1|                1|         1|          1|                 |             1|                 |                 1|              |                 |                  |              |                 |                  |              |                 |                  |           |         1|         1|                  |               |               1| 2012-01-01 08:53|               0|                |            |            |              |              |            |        |            |              |                 |          |          K|           |          |          |                  |    86.5|         A|          |            |            .1|               1|\n|2012-01-01 09:00| 03772|    WMO|          SYNOP|          1|   708|      1011|                 4|           5|           210|        11|          |            |            |             6|               |               |              |               |         30|      3000|      1006.8|           4|               |              45|            |               |                |            |               |                |            |               |                |         |           11.6|     9.5|     10.5|  1003.8|    1007|               |                |         8|             |             0|               6|           6|            |              |              |               6|                 |                 |                |                 |            6|           6|             6|                6|         6|          6|                 |             6|                 |                 6|              |                 |                  |              |                 |                  |              |                 |                  |           |         6|         1|                  |               |               6| 2012-01-01 08:53|               0|                |            |            |              |              |            |        |            |              |                 |          |          K|           |          |          |                  |    86.5|         A|          |            |            .1|               1|\n+----------------+------+-------+---------------+-----------+------+----------+------------------+------------+--------------+----------+----------+------------+------------+--------------+---------------+---------------+--------------+---------------+-----------+----------+------------+------------+---------------+----------------+------------+---------------+----------------+------------+---------------+----------------+------------+---------------+----------------+---------+---------------+--------+---------+--------+--------+---------------+----------------+----------+-------------+--------------+----------------+------------+------------+--------------+--------------+----------------+-----------------+-----------------+----------------+-----------------+-------------+------------+--------------+-----------------+----------+-----------+-----------------+--------------+-----------------+------------------+--------------+-----------------+------------------+--------------+-----------------+------------------+--------------+-----------------+------------------+-----------+----------+----------+------------------+---------------+----------------+-----------------+----------------+----------------+------------+------------+--------------+--------------+------------+--------+------------+--------------+-----------------+----------+-----------+-----------+----------+----------+------------------+--------+----------+----------+------------+--------------+----------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1522956754878_1888740011","id":"20180405-162418_588037029","dateCreated":"2018-04-05T19:32:34+0000","dateStarted":"2018-04-05T19:35:12+0000","dateFinished":"2018-04-05T19:35:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:261"},{"text":"%pyspark\n\n# only get heathrow data (708)\nrainhrly_df = spark.read.csv(\"\".join([\"s3a://\", s3_bucket, weather_path, rainhrly_raw]),\\\n                             header=\"false\",\\\n                             inferSchema=\"false\",\\\n                             schema=rainhrly_schema,\\\n                             dateFormat=\"yyyy-MM-dd\",\\\n                             timestampFormat=\"yyyy-MM-dd HH:mm\",\\\n                             sep=\",\")\\\n                        .filter(\"src_id = ' 708'\")\n\nif debug:\n    rainhrly_df.printSchema()\n    rainhrly_df.show()","user":"anonymous","dateUpdated":"2018-04-05T19:34:43+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- ob_end_time: string (nullable = true)\n |-- id: string (nullable = true)\n |-- id_type: string (nullable = true)\n |-- ob_hour_count: string (nullable = true)\n |-- version_num: string (nullable = true)\n |-- met_domain_name: string (nullable = true)\n |-- src_id: string (nullable = true)\n |-- rec_st_ind: string (nullable = true)\n |-- prcp_amt: string (nullable = true)\n |-- prcp_dur: string (nullable = true)\n |-- prcp_amt_q: string (nullable = true)\n |-- prcp_dur_q: string (nullable = true)\n |-- meto_stmp_time: string (nullable = true)\n |-- midas_stmp_etime: string (nullable = true)\n |-- prcp_amt_j: string (nullable = true)\n\n+----------------+-------+-------+-------------+-----------+---------------+------+----------+--------+--------+----------+----------+-----------------+----------------+----------+\n|     ob_end_time|     id|id_type|ob_hour_count|version_num|met_domain_name|src_id|rec_st_ind|prcp_amt|prcp_dur|prcp_amt_q|prcp_dur_q|   meto_stmp_time|midas_stmp_etime|prcp_amt_j|\n+----------------+-------+-------+-------------+-----------+---------------+------+----------+--------+--------+----------+----------+-----------------+----------------+----------+\n|2012-01-01 00:00| 247539|   RAIN|            1|          1|           SREW|   708|      1011|      .2|        |         1|          | 2011-12-31 23:52|               0|      null|\n|2012-01-01 01:00| 247539|   RAIN|            1|          1|           SREW|   708|      1011|       0|        |         1|          | 2012-01-01 00:52|               0|      null|\n|2012-01-01 02:00| 247539|   RAIN|            1|          1|           SREW|   708|      1011|       0|        |     10001|          | 2012-01-01 01:52|               0|      null|\n|2012-01-01 03:00| 247539|   RAIN|            1|          1|           SREW|   708|      1011|       0|        |     10001|          | 2012-01-01 02:53|               0|      null|\n|2012-01-01 04:00| 247539|   RAIN|            1|          1|           SREW|   708|      1011|       0|        |         1|          | 2012-01-01 03:52|               0|      null|\n|2012-01-01 05:00| 247539|   RAIN|            1|          1|           SREW|   708|      1011|       0|        |         1|          | 2012-01-01 04:52|               0|      null|\n|2012-01-01 06:00| 247539|   RAIN|            1|          1|           SREW|   708|      1011|       0|        |         1|          | 2012-01-01 05:53|               0|      null|\n|2012-01-01 07:00| 247539|   RAIN|            1|          1|           SREW|   708|      1011|       0|        |         1|          | 2012-01-01 06:52|               0|      null|\n|2012-01-01 08:00| 247539|   RAIN|            1|          1|           SREW|   708|      1011|       0|        |         1|          | 2012-01-01 07:52|               0|      null|\n|2012-01-01 09:00| 247539|   RAIN|            1|          1|           SREW|   708|      1011|       0|        |         1|          | 2012-01-01 08:53|               0|      null|\n|2012-01-01 09:00| 247539|   RAIN|           12|          1|            NCM|   708|      1011|      .2|        |         6|          | 2012-01-01 08:53|               0|      null|\n|2012-01-01 10:00| 247539|   RAIN|            1|          1|           SREW|   708|      1011|       0|        |         1|          | 2012-01-01 09:52|               0|      null|\n|2012-01-01 11:00| 247539|   RAIN|            1|          1|           SREW|   708|      1011|       0|        |         1|          | 2012-01-01 10:52|               0|      null|\n|2012-01-01 12:00| 247539|   RAIN|            1|          1|           SREW|   708|      1011|       0|        |         1|          | 2012-01-01 11:54|               0|      null|\n|2012-01-01 13:00| 247539|   RAIN|            1|          1|           SREW|   708|      1011|       0|        |         1|          | 2012-01-01 12:52|               0|      null|\n|2012-01-01 14:00| 247539|   RAIN|            1|          1|           SREW|   708|      1011|       0|        |     10001|          | 2012-01-01 13:52|               0|      null|\n|2012-01-01 15:00| 247539|   RAIN|            1|          1|           SREW|   708|      1011|     4.2|        |         1|          | 2012-01-01 14:52|               0|      null|\n|2012-01-01 16:00| 247539|   RAIN|            1|          1|           SREW|   708|      1011|     2.2|        |         1|          | 2012-01-01 15:52|               0|      null|\n|2012-01-01 17:00| 247539|   RAIN|            1|          1|           SREW|   708|      1011|      .6|        |         1|          | 2012-01-01 16:52|               0|      null|\n|2012-01-01 18:00| 247539|   RAIN|            1|          1|           SREW|   708|      1011|       0|        |     10001|          | 2012-01-01 17:52|               0|      null|\n+----------------+-------+-------+-------------+-----------+---------------+------+----------+--------+--------+----------+----------+-----------------+----------------+----------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1522956754878_1888740011","id":"20180405-175800_288167348","dateCreated":"2018-04-05T19:32:34+0000","dateStarted":"2018-04-05T19:35:13+0000","dateFinished":"2018-04-05T19:35:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:262"},{"text":"%pyspark\n\nldn_df = londonstation_df.select([\"SRC_ID\", \"SRC_NAME\", \"ID_T\", \"ID\", \"MET_DOMA\", \"LOC_\", \"HIGH_PRCN_LAT\", \"HIGH_PRCN_LON\", \"ELEVATION\"])\nldn_df.orderBy('SRC_ID').show()","user":"anonymous","dateUpdated":"2018-04-05T19:34:43+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+--------+----+------+--------+----+-------------+-------------+---------+\n|SRC_ID|SRC_NAME|ID_T|    ID|MET_DOMA|LOC_|HIGH_PRCN_LAT|HIGH_PRCN_LON|ELEVATION|\n+------+--------+----+------+--------+----+-------------+-------------+---------+\n|   708|HEATHROW|RAIN|247536|   CLMSN| GLN|       51.479|       -0.449|       25|\n|   708|HEATHROW| WMO|  3772|CLM71-06| GLN|       51.479|       -0.449|       25|\n|   708|HEATHROW|DCNN|  5113|HSUN3445| GLN|       51.479|       -0.449|       25|\n|   708|HEATHROW|WIND|511302|HWNDAUTO| GLN|       51.479|       -0.449|       25|\n|   708|HEATHROW|WIND|511302|HWND6910| GLN|       51.479|       -0.449|       25|\n|   708|HEATHROW|RAIN|247539|    SREW| GLN|       51.479|       -0.449|       25|\n|   708|HEATHROW|WIND|511305|     HCM| GLN|       51.479|       -0.449|       25|\n|   708|HEATHROW|WIND|511301|HWND6910| GLN|       51.479|       -0.449|       25|\n|   708|HEATHROW| WMO|  3772|     HCM| GLN|       51.479|       -0.449|       25|\n|   708|HEATHROW|WIND|511304|     HCM| GLN|       51.479|       -0.449|       25|\n|   708|HEATHROW|DCNN|  5113|   SYNOP| GLN|       51.479|       -0.449|       25|\n|   708|HEATHROW| WMO|  3772|   CLM71| GLN|       51.479|       -0.449|       25|\n|   708|HEATHROW|DCNN|  5113|  CARLOS| GLN|       51.479|       -0.449|       25|\n|   708|HEATHROW|RAIN|247536| WAHRAIN| GLN|       51.479|       -0.449|       25|\n|   708|HEATHROW|RAIN|247536| WADRAIN| GLN|       51.479|       -0.449|       25|\n|   708|HEATHROW| WMO|  3772|   SYNOP| GLN|       51.479|       -0.449|       25|\n|   708|HEATHROW|RAIN|247537|    SSER| GLN|       51.479|       -0.449|       25|\n|   708|HEATHROW|RAIN|247536|    SREW| GLN|       51.479|       -0.449|       25|\n|   708|HEATHROW|RAIN|247536|    SREW| GLN|       51.479|       -0.449|       25|\n|   708|HEATHROW| WMO|  3772|    SREW| GLN|       51.479|       -0.449|       25|\n+------+--------+----+------+--------+----+-------------+-------------+---------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1522956754879_1888355262","id":"20180405-171243_1347238945","dateCreated":"2018-04-05T19:32:34+0000","dateStarted":"2018-04-05T19:35:16+0000","dateFinished":"2018-04-05T19:35:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:263"},{"text":"%pyspark\n\nfrom pyspark.sql.functions import trim, col, regexp_replace, to_timestamp\n\nwx_df = wxhrly_df.select(trim(col(\"src_id\")).alias(\"SRC_ID\"),\\\n                         trim(col(\"id_type\")).alias(\"ID_T\"),\\\n                         trim(col(\"met_domain_name\")).alias(\"MET_DOMA\"),\\\n                         trim(col(\"id\")).alias(\"ID\"),\\\n                         to_timestamp(trim(col(\"ob_time\")), \"yyyy-MM-dd HH:mm\").alias(\"ob_time\"),\\\n                         trim(col(\"air_temperature\")).cast(\"float\").alias(\"air_temperature\"),\\\n                         trim(col(\"wind_speed\")).cast(\"int\").alias(\"wind_speed\"),\\\n                         trim(col(\"wind_direction\")).cast(\"int\").alias(\"wind_direction\"))\\\n                 .withColumn(\"ID\", regexp_replace(\"ID\", \"^0+\", \"\"))\\\n                 .repartition(30, \"ob_time\")\n                 \nif debug:\n    wx_df.printSchema()\n#    wx_df.show()","user":"anonymous","dateUpdated":"2018-04-05T19:34:43+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- SRC_ID: string (nullable = true)\n |-- ID_T: string (nullable = true)\n |-- MET_DOMA: string (nullable = true)\n |-- ID: string (nullable = true)\n |-- ob_time: timestamp (nullable = true)\n |-- air_temperature: float (nullable = true)\n |-- wind_speed: integer (nullable = true)\n |-- wind_direction: integer (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1522956754879_1888355262","id":"20180405-160204_1476587434","dateCreated":"2018-04-05T19:32:34+0000","dateStarted":"2018-04-05T19:35:17+0000","dateFinished":"2018-04-05T19:35:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:264"},{"text":"%pyspark\n\nfrom pyspark.sql.functions import trim, col, regexp_replace, to_timestamp, to_utc_timestamp\n\n# Observation time in rainfall data is recorded for rainfall in last 1 hour\n# To offset the hour difference, we are using UTC+1 as timezone such that the time in dataframe will be one hour later\nrain_df = rainhrly_df.select(trim(col(\"src_id\")).alias(\"SRC_ID\"),\\\n                             trim(col(\"id_type\")).alias(\"ID_T\"),\\\n                             trim(col(\"met_domain_name\")).alias(\"MET_DOMA\"),\\\n                             trim(col(\"id\")).alias(\"ID\"),\\\n                             to_utc_timestamp(trim(col(\"ob_end_time\")), \"GMT+1\").alias(\"ob_time\"),\\\n                             trim(col(\"prcp_amt\")).cast(\"float\").alias(\"prcp_amt\"),\\\n                             trim(col(\"prcp_dur\")).cast(\"float\").alias(\"prcp_dur\"))\\\n                     .withColumn(\"ID\", regexp_replace(\"ID\", \"^0+\", \"\"))\\\n                     .filter(\"MET_DOMA = 'SREW'\")\\\n                     .repartition(30, \"ob_time\")\n                     \nif debug:\n    rain_df.printSchema()\n#    rain_df.show()","user":"anonymous","dateUpdated":"2018-04-05T19:34:43+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- SRC_ID: string (nullable = true)\n |-- ID_T: string (nullable = true)\n |-- MET_DOMA: string (nullable = true)\n |-- ID: string (nullable = true)\n |-- ob_time: timestamp (nullable = true)\n |-- prcp_amt: float (nullable = true)\n |-- prcp_dur: float (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1522956754880_1874119552","id":"20180405-175859_1769666137","dateCreated":"2018-04-05T19:32:34+0000","dateStarted":"2018-04-05T19:35:19+0000","dateFinished":"2018-04-05T19:35:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:265"},{"text":"%pyspark\n\n# weather_df = wx_df.join(ldn_df, [\"SRC_ID\", \"ID_T\", \"MET_DOMA\", \"ID\"], \"inner\")\\\n#                   .select(\"SRC_ID\", \"SRC_NAME\", \"HIGH_PRCN_LAT\", \"HIGH_PRCN_LON\", \"ob_time\", \"air_temperature\", \"wind_speed\", \"wind_direction\")\n\n# if debug:\n#     weather_df.printSchema()\n#     weather_df.show()","user":"anonymous","dateUpdated":"2018-04-05T19:51:45+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python","tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\n"}]},"apps":[],"jobName":"paragraph_1522956754880_1874119552","id":"20180405-170719_1651005196","dateCreated":"2018-04-05T19:32:34+0000","dateStarted":"2018-04-05T19:51:45+0000","dateFinished":"2018-04-05T19:51:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:266"},{"text":"%pyspark\n\n# rainfall_df = rain_df.join(ldn_df, [\"SRC_ID\", \"ID_T\", \"MET_DOMA\", \"ID\"], \"inner\")\\\n#                      .select(\"SRC_ID\", \"SRC_NAME\", \"HIGH_PRCN_LAT\", \"HIGH_PRCN_LON\", \"ob_time\", \"prcp_amt\", \"prcp_dur\")\n\n# if debug:\n#     rainfall_df.printSchema()\n#     rainfall_df.show()\nprint \"\"","user":"anonymous","dateUpdated":"2018-04-05T19:51:49+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python","tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\n"}]},"apps":[],"jobName":"paragraph_1522956754890_1871811059","id":"20180405-172012_1187058637","dateCreated":"2018-04-05T19:32:34+0000","dateStarted":"2018-04-05T19:51:49+0000","dateFinished":"2018-04-05T19:51:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:267"},{"text":"%pyspark\n\nfrom pyspark.sql.functions import year, month, dayofmonth, dayofyear\n\ncombined_weather_df = wx_df.join(rain_df, [\"SRC_ID\", \"ob_time\"], \"inner\")\\\n                           .select([\"ob_time\", \"air_temperature\", \"wind_speed\", \"wind_direction\", \"prcp_amt\", \"prcp_dur\",\\\n                                    year(\"ob_time\").alias(\"year\"),\\\n                                    month(\"ob_time\").alias(\"month\"),\\\n                                    dayofmonth(\"ob_time\").alias(\"day\")])\n\nif debug:\n    combined_weather_df.printSchema()\n#    combined_weather_df.show()","user":"anonymous","dateUpdated":"2018-04-05T19:34:44+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- ob_time: timestamp (nullable = true)\n |-- air_temperature: float (nullable = true)\n |-- wind_speed: integer (nullable = true)\n |-- wind_direction: integer (nullable = true)\n |-- prcp_amt: float (nullable = true)\n |-- prcp_dur: float (nullable = true)\n |-- year: integer (nullable = true)\n |-- month: integer (nullable = true)\n |-- day: integer (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1522956754890_1871811059","id":"20180405-175216_953139997","dateCreated":"2018-04-05T19:32:34+0000","dateStarted":"2018-04-05T19:35:19+0000","dateFinished":"2018-04-05T19:35:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:268"},{"text":"%pyspark\n\ncombined_weather_df.coalesce(1)\\\n                   .write\\\n                   .option(\"mapreduce.fileoutputcommitter.algorithm.version\", \"2\")\\\n                   .partitionBy(\"year\", \"month\")\\\n                   .parquet(\"s3a://\" + s3_bucket + processed_path + \"/weather-midas/data\", mode=\"append\")","user":"anonymous","dateUpdated":"2018-04-05T19:52:21+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python","tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1522956754890_1871811059","id":"20180405-182104_535125034","dateCreated":"2018-04-05T19:32:34+0000","dateStarted":"2018-04-05T19:41:20+0000","dateFinished":"2018-04-05T19:45:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:269"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2018-04-05T19:34:44+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1522956754890_1871811059","id":"20180405-190630_82895572","dateCreated":"2018-04-05T19:32:34+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:270"}],"name":"Weather Data New","id":"2D9NJ4H38","angularObjects":{"2BRWU4WXC:shared_process":[],"2AM1YV5CU:shared_process":[],"2AJXGMUUJ:shared_process":[],"2ANGGHHMQ:shared_process":[],"2AKK3QQXU:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}